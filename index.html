<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grimoire | Nocturnal Notes</title>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Playfair+Display:ital@0;1&display=swap" rel="stylesheet">
    <style>
        :root {
            --oxblood: #1a0505; --crimson: #8b0000; --parchment: #f5e6d3;
            --ink: #0a0a0a; --silver: #a9a9a9;
        }

        body {
            background-color: var(--ink); color: var(--parchment);
            font-family: 'Playfair Display', serif; margin: 0;
            display: flex; height: 100vh; overflow: hidden;
        }

        /* Sidebar & Recent Notes */
        #sidebar {
            width: 280px; background-color: var(--oxblood);
            border-right: 1px solid var(--crimson); padding: 20px;
            display: flex; flex-direction: column;
        }

        h1 { font-family: 'Cinzel', serif; color: var(--crimson); text-align: center; border-bottom: 2px solid var(--crimson); padding-bottom: 10px; }

        .recent-list { list-style: none; padding: 0; overflow-y: auto; flex-grow: 1; }
        .note-thumb { 
            padding: 10px; border-bottom: 1px solid rgba(139, 0, 0, 0.3); 
            cursor: pointer; font-size: 0.9rem; transition: 0.3s;
        }
        .note-thumb:hover { background: rgba(139, 0, 0, 0.2); }

        /* Toolbar */
        .toolbar {
            display: flex; gap: 15px; background: rgba(0,0,0,0.5);
            padding: 10px; border-bottom: 1px solid var(--crimson);
        }
        .tool-btn { 
            background: none; border: 1px solid var(--crimson); 
            color: var(--parchment); cursor: pointer; font-family: 'Cinzel';
            padding: 5px 10px; font-size: 0.8rem;
        }
        .tool-btn:hover { background: var(--crimson); color: white; }

        /* Editor Area */
        #editor-container { flex-grow: 1; display: flex; flex-direction: column; background: radial-gradient(circle, #1a0505 0%, #0a0a0a 100%); }
        
        #note-title {
            background: transparent; border: none; border-bottom: 1px solid var(--crimson);
            color: var(--crimson); font-family: 'Cinzel', serif; font-size: 2rem;
            outline: none; margin: 20px 40px;
        }

        #note-body {
            flex-grow: 1; margin: 0 40px; padding: 20px;
            color: var(--parchment); font-size: 1.2rem; line-height: 1.6;
            outline: none; overflow-y: auto;
        }

        /* Image Thumbnails in Note */
        #note-body img {
            max-width: 200px; border: 2px solid var(--crimson);
            margin: 10px; box-shadow: 0 0 15px rgba(139, 0, 0, 0.5);
        }

        .save-btn {
            background: var(--crimson); color: white; border: none;
            font-family: 'Cinzel'; padding: 10px; cursor: pointer;
            margin-top: 10px; box-shadow: 0 0 10px var(--crimson);
        }
    </style>
</head>
<body>

    <section id="sidebar">
        <h1>Grimoire</h1>
        <button class="save-btn" onclick="saveNote()">+ Create New Entry</button>
        <h3 style="font-family: 'Cinzel'; font-size: 0.8rem; margin-top: 20px; color: var(--silver);">Recent Chronicles</h3>
        <div id="recent-list" class="recent-list"></div>
    </section>

    <main id="editor-container">
        <div class="toolbar">
            <button class="tool-btn" onclick="format('bold')">B</button>
            <button class="tool-btn" onclick="format('italic')">I</button>
            <button class="tool-btn" onclick="document.getElementById('imgInput').click()">Add Relic (Image)</button>
            <input type="file" id="imgInput" hidden accept="image/*" onchange="insertImage(event)">
        </div>

        <input type="text" id="note-title" placeholder="Untitled Chronicle...">
        <div id="note-body" contenteditable="true" placeholder="Begin your writing..."></div>
    </main>

    <script>
        // Formatting function
        function format(cmd) {
            document.execCommand(cmd, false, null);
        }

        // Image handling
        function insertImage(event) {
            const file = event.target.files[0];
            const reader = new FileReader();
            reader.onload = function(e) {
                const img = `<img src="${e.target.result}" class="note-img" />`;
                document.execCommand('insertHTML', false, img);
            }
            reader.readAsDataURL(file);
        }

        // Save to LocalStorage (Syncs via Browser/Account)
        function saveNote() {
            const title = document.getElementById('note-title').value || "Untitled";
            const body = document.getElementById('note-body').innerHTML;
            const timestamp = new Date().toLocaleString();

            if (!body) return;

            const note = { title, body, timestamp };
            let notes = JSON.parse(localStorage.getItem('gothic_notes') || '[]');
            notes.unshift(note);
            localStorage.setItem('gothic_notes', JSON.stringify(notes));
            
            renderRecent();
            clearEditor();
        }

        function renderRecent() {
            const list = document.getElementById('recent-list');
            const notes = JSON.parse(localStorage.getItem('gothic_notes') || '[]');
            list.innerHTML = notes.map((n, i) => `
                <div class="note-thumb" onclick="loadNote(${i})">
                    <strong>${n.title}</strong><br>
                    <small style="color:var(--silver)">${n.timestamp}</small>
                </div>
            `).join('');
        }

        function loadNote(index) {
            const notes = JSON.parse(localStorage.getItem('gothic_notes') || '[]');
            const note = notes[index];
            document.getElementById('note-title').value = note.title;
            document.getElementById('note-body').innerHTML = note.body;
        }

        function clearEditor() {
            document.getElementById('note-title').value = "";
            document.getElementById('note-body').innerHTML = "";
        }

        window.onload = renderRecent;
    </script>
</body>
</html>
